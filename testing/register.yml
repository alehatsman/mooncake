---
- name: Check if command exists
  shell: which git
  register: git_check

- name: Show git path
  shell: echo "Git is at {{ git_check_stdout }}"
  when: git_check_rc == 0

- name: Check nonexistent command
  shell: which nonexistent_command_xyz
  register: missing_check

- name: Handle missing command
  shell: echo "Command not found (exit code {{ missing_check_rc }})"
  when: missing_check_rc != 0

- name: Get current user
  shell: whoami
  register: current_user

- name: Get user home
  shell: echo $HOME
  register: user_home

- name: Show user info
  shell: echo "User {{ current_user_stdout }} has home {{ user_home_stdout }}"

- name: Create test file
  file:
    path: /tmp/mooncake_test.txt
    state: file
    content: "Hello from mooncake"
  register: file_result

- name: Show if file changed
  shell: |
    if [ "{{ file_result_changed }}" = "true" ]; then
      echo "File was created or modified"
    else
      echo "File already existed"
    fi

- name: List directory
  shell: ls -la /tmp | head -5
  register: dir_list

- name: Show directory output
  shell: 'echo "First line was: {{ dir_list_stdout }}"'
