# Kafka Uninstallation Tasks

- name: Stop Kafka service (macOS)
  shell: brew services stop kafka
  when: os == "darwin"
  failed_when: false

- name: Stop Kafka service (Linux)
  shell: |
    pkill -f kafka.Kafka
    pkill -f zookeeper
  when: os == "linux"
  failed_when: false

- name: Uninstall Kafka (macOS)
  shell: brew uninstall kafka
  when: os == "darwin"

- name: Remove Kafka directory (Linux)
  file:
    path: /opt/kafka
    state: absent
  become: true
  when: os == "linux"

- name: Remove Kafka user (Linux)
  shell: sudo userdel kafka
  become: true
  when: os == "linux"
  failed_when: false

- name: Display uninstall confirmation
  print: "Kafka uninstalled. Data directory preserved at {{ parameters.data_dir }}"
