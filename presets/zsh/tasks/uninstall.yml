# Zsh Uninstallation Tasks

- name: Reset to bash shell
  shell: chsh -s /bin/bash
  failed_when: false

- name: Remove Oh My Zsh
  shell: rm -rf ~/.oh-my-zsh
  when: parameters.install_ohmyzsh

- name: Remove Zsh config
  shell: rm -f ~/.zshrc ~/.zshrc.bak ~/.zsh_history

- name: Uninstall Zsh via Homebrew
  shell: brew uninstall zsh
  when: brew_available
  failed_when: false

- name: Uninstall Zsh via apt
  package:
    name: zsh
    state: absent
  become: true
  when: apt_available

- name: Uninstall Zsh via dnf
  package:
    name: zsh
    state: absent
  become: true
  when: dnf_available

- name: Uninstall Zsh via yum
  package:
    name: zsh
    state: absent
  become: true
  when: yum_available

- name: Verify uninstallation with assert
  assert:
    command:
      cmd: command -v zsh
      exit_code: 1

- name: Display uninstall confirmation
  print: "Zsh uninstalled. Shell reset to bash."
