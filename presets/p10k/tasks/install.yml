- name: Check if p10k is installed
  assert:
    file:
      path: "${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/themes/powerlevel10k"
      exists: true
  register: p10k_check
  failed_when: false

- name: Install p10k via Homebrew
  package:
    name: romkatv/powerlevel10k/powerlevel10k
    state: present
  when: brew_available and p10k_check.failed

- name: Install p10k via git clone
  shell: git clone --depth=1 https://github.com/romkatv/powerlevel10k.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/themes/powerlevel10k
  when: linux and p10k_check.failed

- name: Verify installation with assert
  assert:
    file:
      path: "${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/themes/powerlevel10k"
      exists: true

- name: Display confirmation
  print: "p10k installed"
