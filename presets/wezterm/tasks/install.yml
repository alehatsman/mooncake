- name: Check if wezterm is installed
  shell: command -v wezterm
  register: wezterm_check
  failed_when: false

- name: Install wezterm (macOS)
  package:
    name: wezterm
    state: present
  when: brew_available and wezterm_check.rc != 0

- name: Install wezterm (Linux)
  shell: |
    curl -fsSL https://apt.fury.io/wez/gpg.key | sudo gpg --dearmor -o /etc/apt/keyrings/wezterm-fury.gpg
    echo 'deb [signed-by=/etc/apt/keyrings/wezterm-fury.gpg] https://apt.fury.io/wez/ * *' | sudo tee /etc/apt/sources.list.d/wezterm.list
    sudo apt update && sudo apt install -y wezterm
  when: apt_available and wezterm_check.rc != 0

- name: Verify installation with assert
  assert:
    command:
      cmd: command -v wezterm
      exit_code: 0

- name: Display confirmation
  print: "wezterm installed"
