# MySQL Installation Tasks

- name: Check if MySQL is already installed
  shell: command -v mysql
  register: mysql_check
  failed_when: false

# macOS Installation
- name: Install MySQL via Homebrew (macOS)
  package:
    name: mysql
    state: present
  when: brew_available and mysql_check.rc != 0

# Linux - Debian/Ubuntu
- name: Install MySQL (Debian/Ubuntu)
  package:
    name: mysql-server
    state: present
  become: true
  when: apt_available and mysql_check.rc != 0

# Linux - RHEL/Fedora/CentOS
- name: Install MySQL (RHEL/Fedora/CentOS)
  package:
    name: mysql-server
    state: present
  become: true
  when: dnf_available or yum_available and mysql_check.rc != 0

# Linux - Arch
- name: Install MySQL (Arch)
  package:
    name: mysql
    state: present
  become: true
  when: pacman_available and mysql_check.rc != 0

# Verify installation
- name: Verify mysql is installed
  assert:
    command:
      cmd: command -v mysql
      exit_code: 0

- name: Display MySQL version
  shell: mysql --version
  register: mysql_version

- name: Print version
  print: "MySQL installed: {{ mysql_version.stdout }}"
