- name: Check if singer is installed
  shell: pip3 show singer-python
  register: singer_check
  failed_when: false

- name: Install singer (macOS)
  shell: pip3 install --user singer-python
  when: brew_available and singer_check.rc != 0

- name: Install singer (Linux)
  shell: pip3 install --user singer-python
  when: linux and singer_check.rc != 0

- name: Verify installation with assert
  assert:
    command:
      cmd: pip3 show singer-python
      exit_code: 0

- name: Display confirmation
  print: "singer installed"
