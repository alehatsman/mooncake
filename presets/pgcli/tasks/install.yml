- name: Check if pgcli is installed
  shell: command -v pgcli
  register: pgcli_check
  failed_when: false

- name: Install  via Homebrew
  package:
    name: pgcli
    state: present
  when: brew_available and pgcli_check.rc != 0

- name: Install pgcli via apt
  shell: pip3 install --user pgcli
  when: linux and pgcli_check.rc != 0

- name: Verify installation with assert
  assert:
    command:
      cmd: command -v pgcli
      exit_code: 0

- name: Display confirmation
  print: "pgcli installed"
