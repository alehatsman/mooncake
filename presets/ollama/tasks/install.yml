# Ollama Installation Tasks
# Handles installation via package manager or official script

- name: Check if Ollama is already installed
  shell: command -v ollama
  register: ollama_check
  failed_when: false

# Package Manager Installation
- name: Install Ollama via package manager
  package:
    name: ollama
    state: present
  become: true
  when: (ollama_check.rc != 0) and (parameters.method == "package")

# Official Script Installation
- name: Install Ollama via official script
  shell: curl -fsSL https://ollama.com/install.sh | sh
  become: true
  when: (ollama_check.rc != 0) and ((parameters.method == "auto") or (parameters.method == "script"))

- name: Verify installation
  assert:
    command:
      cmd: command -v ollama
      exit_code: 0
