- name: Check if jenv is installed
  shell: command -v jenv
  register: jenv_check
  failed_when: false

- name: Install jenv (macOS)
  package:
    name: jenv
    state: present
  when: brew_available and jenv_check.rc != 0

- name: Install jenv (Linux)
  shell: |
    git clone https://github.com/jenv/jenv.git ~/.jenv
    echo 'export PATH="$HOME/.jenv/bin:$PATH"' >> ~/.bashrc
    echo 'eval "$(jenv init -)"' >> ~/.bashrc
  when: linux and jenv_check.rc != 0

- name: Verify installation with assert
  assert:
    command:
      cmd: command -v jenv
      exit_code: 0

- name: Display confirmation
  print: "jenv installed"
