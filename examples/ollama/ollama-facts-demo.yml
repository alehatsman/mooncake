# Ollama Facts and Integration Demo
# Shows automatic Ollama detection and conditional usage

- name: Display detected Ollama facts
  shell: |
    echo "========================================="
    echo "üîç System Facts - Ollama Detection"
    echo "========================================="
    echo ""
    echo "Ollama Version{{":"}}  {{ ollama_version }}"
    echo "Ollama Endpoint{{":"}} {{ ollama_endpoint }}"
    echo ""
    echo "========================================="

- name: Check if Ollama is installed
  shell: echo "Ollama is detected on this system"
  when: "{{ ollama_version != \"\" }}"

- name: Check if Ollama is NOT installed
  shell: echo "Ollama is NOT installed on this system"
  when: "{{ ollama_version == \"\" }}"

- name: Conditional step - only runs if Ollama present
  shell: echo "‚úì Ollama {{ ollama_version }} detected and ready to use!"
  when: "{{ ollama_version != \"\" }}"

- name: Show Ollama API endpoint
  shell: curl -s {{ ollama_endpoint }}/api/tags | head -20
  when: "{{ ollama_version != \"\" }}"
  register: api_response
  failed_when: false

- name: Display API response
  shell: |
    echo ""
    echo "========================================="
    echo "üì° Ollama API Response"
    echo "========================================="
    echo "{{ api_response.stdout }}"
    echo "========================================="
  when: "{{ ollama_version != \"\" }}"

- name: Example - Would install Ollama if not present
  shell: echo "‚ÑπÔ∏è  Ollama not found - would install with ollama action"
  when: "{{ ollama_version == \"\" }}"

- name: Show integration example
  shell: |
    echo ""
    echo "========================================="
    echo "üéØ Ollama Action Usage Examples"
    echo "========================================="
    echo ""
    echo "Example 1 - Install with models"
    echo "  ollama with state present"
    echo "  service enabled, pull models"
    echo ""
    echo "Example 2 - Configure service"
    echo "  ollama with custom host"
    echo "  environment variables"
    echo ""
    echo "Example 3 - Uninstall"
    echo "  ollama state absent"
    echo "  force flag removes models"
    echo ""
    echo "========================================="
